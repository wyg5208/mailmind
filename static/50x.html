<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>系统维护中 - AI邮件简报系统</title>
    <link href="/static/vendor/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="/static/vendor/fontawesome/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        /* 维护页面专用样式 */
        .maintenance-card {
            transition: all 0.3s ease;
        }
        
        .maintenance-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .detail-card {
            transition: all 0.2s ease;
            border: 1px solid #e2e8f0;
        }
        
        .detail-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .maintenance-status .spinner-border {
            animation: spin 1s linear infinite;
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .feature-item {
            transition: background-color 0.2s ease;
        }
        
        .feature-item:hover {
            background-color: rgba(0,0,0,0.02);
        }
        
        /* 脉冲动画 */
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .maintenance-status {
            animation: pulse 2s infinite;
        }
        
        /* 进度条动画 */
        @keyframes progress-animation {
            0% { background-position: 0 0; }
            100% { background-position: 40px 0; }
        }
        
        .progress-bar-animated {
            animation: progress-animation 1s linear infinite;
        }
        
        /* 响应式优化 */
        @media (max-width: 768px) {
            .maintenance-card .card-header {
                padding: 1rem;
            }
            
            .maintenance-card .card-header .d-flex {
                flex-direction: column;
                text-align: center;
            }
            
            .maintenance-card .card-header .text-end {
                margin-top: 1rem;
                text-align: center !important;
            }
            
            .detail-card {
                margin-bottom: 1rem;
            }
        }
        
        /* 导航栏样式 */
        .navbar {
            background: var(--gradient-primary) !important;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(10px);
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
        }
        
        /* 主内容区域 */
        .main-content {
            margin-top: 80px;
            margin-bottom: 2rem;
            min-height: calc(100vh - 200px);
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
    <div class="container">
            <a class="navbar-brand fw-bold" href="/">
                <i class="fas fa-envelope-open-text me-2"></i>AI邮件简报系统
            </a>
            <div class="navbar-nav ms-auto">
                <span class="nav-link text-white">
                    <i class="fas fa-tools me-1"></i>系统维护中
                </span>
            </div>
        </div>
    </nav>

    <!-- 主内容区域 -->
    <main class="main-content">
        <div class="container">
            <!-- 维护状态统计卡片 -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="row">
                        <div class="col-6 col-md-3 col-lg-3 mb-2">
                            <div class="stat-card-mini card border-0 shadow-sm">
                                <div class="card-body text-center py-2">
                                    <div class="d-flex align-items-center">
                                        <div class="stat-icon-mini bg-danger bg-opacity-10 rounded-circle me-2">
                                            <i class="fas fa-tools text-danger"></i>
                                        </div>
                                        <h6 class="stat-number-mini text-danger mb-0 me-2">500</h6>
                                        <small class="stat-label-mini text-muted">维护代码</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3 col-lg-3 mb-2">
                            <div class="stat-card-mini card border-0 shadow-sm">
                                <div class="card-body text-center py-2">
                                    <div class="d-flex align-items-center">
                                        <div class="stat-icon-mini bg-info bg-opacity-10 rounded-circle me-2">
                                            <i class="fas fa-clock text-info"></i>
                                        </div>
                                        <h6 class="stat-number-mini text-info mb-0 me-2" id="maintenance-progress">0</h6>
                                        <small class="stat-label-mini text-muted">进度百分比</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3 col-lg-3 mb-2">
                            <div class="stat-card-mini card border-0 shadow-sm">
                                <div class="card-body text-center py-2">
                                    <div class="d-flex align-items-center">
                                        <div class="stat-icon-mini bg-success bg-opacity-10 rounded-circle me-2">
                                            <i class="fas fa-calendar-check text-success"></i>
                                        </div>
                                        <h6 class="stat-number-mini text-success mb-0 me-2" id="estimated-time">--</h6>
                                        <small class="stat-label-mini text-muted">预计完成</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3 col-lg-3 mb-2">
                            <div class="stat-card-mini card border-0 shadow-sm">
                                <div class="card-body text-center py-2">
                                    <div class="d-flex align-items-center">
                                        <div class="stat-icon-mini bg-primary bg-opacity-10 rounded-circle me-2">
                                            <i class="fas fa-server text-primary"></i>
                                        </div>
                                        <h6 class="stat-number-mini text-primary mb-0 me-2">升级</h6>
                                        <small class="stat-label-mini text-muted">维护类型</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 主要维护信息卡片 -->
            <div class="row">
                <div class="col-12">
                    <div class="maintenance-card card border-0 shadow-sm mb-4">
                        <div class="card-header bg-gradient-primary text-white">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h4 class="card-title mb-1">
                                        <i class="fas fa-wrench me-2"></i>系统升级维护中
                                    </h4>
                                    <p class="card-subtitle mb-0 opacity-75">
                                        <i class="fas fa-info-circle me-1"></i>
                                        为了提供更好的服务体验，系统正在进行升级维护
                                    </p>
                                </div>
                                <div class="text-end">
                                    <span class="badge bg-light text-primary fs-6 px-3 py-2">
                                        <i class="fas fa-code me-1"></i>维护代码: 500
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-body">
                            <!-- 维护状态摘要 -->
                            <div class="alert alert-danger border-0 bg-danger bg-opacity-10 mb-4">
                                <div class="d-flex">
                                    <div class="flex-shrink-0">
                                        <i class="fas fa-exclamation-triangle text-danger"></i>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div class="flex-grow-1">
                                                <h6 class="alert-heading mb-2">紧急维护状态</h6>
                                                <p class="mb-0">
                                                    系统正在进行紧急升级维护，包括核心服务重启、数据库优化和安全补丁更新。
                                                    维护期间所有功能暂时不可用，我们正在全力恢复服务。
                                                </p>
                                            </div>
                                            <div class="flex-shrink-0 ms-3">
                                                <div class="maintenance-status">
                                                    <div class="spinner-border text-danger" role="status" style="width: 2rem; height: 2rem;">
                                                        <span class="visually-hidden">紧急维护中...</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 维护进度条 -->
                            <div class="maintenance-progress mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <h6 class="mb-0">
                                        <i class="fas fa-tasks text-primary me-2"></i>恢复进度
                                    </h6>
                                    <small class="text-muted">
                                        <span id="progress-text">正在恢复中...</span>
                                    </small>
                                </div>
                                <div class="progress" style="height: 8px;">
                                    <div class="progress-bar bg-gradient-primary progress-bar-striped progress-bar-animated" 
                                         role="progressbar" 
                                         id="progress-bar"
                                         style="width: 0%"
                                         aria-valuenow="0" 
                                         aria-valuemin="0" 
                                         aria-valuemax="100">
                                    </div>
                                </div>
                            </div>

                            <!-- 维护详情 -->
                            <div class="maintenance-details">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="detail-card p-3 bg-light rounded">
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="fas fa-clock text-info me-2"></i>
                                                <strong>开始时间</strong>
                                            </div>
                                            <p class="mb-0 text-muted" id="start-time">--</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <div class="detail-card p-3 bg-light rounded">
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="fas fa-flag-checkered text-success me-2"></i>
                                                <strong>预计完成</strong>
                                            </div>
                                            <p class="mb-0 text-muted" id="end-time">--</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="detail-card p-3 bg-light rounded">
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="fas fa-cogs text-warning me-2"></i>
                                                <strong>维护类型</strong>
                                            </div>
                                            <p class="mb-0 text-muted">紧急升级 & 服务恢复</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <div class="detail-card p-3 bg-light rounded">
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="fas fa-shield-alt text-primary me-2"></i>
                                                <strong>数据安全</strong>
                                            </div>
                                            <p class="mb-0 text-muted">所有数据已安全备份</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-footer bg-light">
                            <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">
                                    <i class="fas fa-info-circle me-1"></i>
                                    维护完成后系统将自动恢复正常服务
                        </small>
                                <div>
                                    <button class="btn btn-outline-primary btn-sm" onclick="location.reload()">
                                        <i class="fas fa-sync-alt me-1"></i>刷新状态
                                    </button>
                                    <a href="mailto:support@example.com" class="btn btn-outline-secondary btn-sm ms-2">
                                        <i class="fas fa-envelope me-1"></i>联系支持
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 系统信息 -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="system-info card border-0 shadow-sm">
                        <div class="card-header bg-light">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-info-circle me-2"></i>维护信息
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <div class="info-item">
                                        <strong class="text-muted">维护版本:</strong>
                                        <span class="ms-2 badge bg-danger">v2.1.0-hotfix</span>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="info-item">
                                        <strong class="text-muted">预计时长:</strong>
                                        <span class="ms-2">约 1 小时</span>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="info-item">
                                        <strong class="text-muted">影响范围:</strong>
                                        <span class="ms-2">全部功能</span>
                                    </div>
                                </div>
                            </div>
                            
                            <hr>
                            <h6 class="text-muted mb-3">紧急修复内容</h6>
                            <div class="upgrade-features">
                                <div class="feature-item d-flex justify-content-between align-items-center py-2 border-bottom">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-server text-danger me-2"></i>
                                        <span>核心服务重启</span>
                                    </div>
                                    <span class="badge bg-warning">进行中</span>
                                </div>
                                <div class="feature-item d-flex justify-content-between align-items-center py-2 border-bottom">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-database text-info me-2"></i>
                                        <span>数据库优化</span>
                                    </div>
                                    <span class="badge bg-secondary">待开始</span>
                                </div>
                                <div class="feature-item d-flex justify-content-between align-items-center py-2 border-bottom">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-shield-alt text-success me-2"></i>
                                        <span>安全补丁更新</span>
                                    </div>
                                    <span class="badge bg-secondary">待开始</span>
                                </div>
                                <div class="feature-item d-flex justify-content-between align-items-center py-2">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-check-circle text-primary me-2"></i>
                                        <span>服务验证测试</span>
                                    </div>
                                    <span class="badge bg-secondary">待开始</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer bg-light mt-5">
        <div class="container">
            <div class="row py-4">
                <div class="col-md-6">
                    <h6 class="text-muted">AI邮件简报系统</h6>
                    <p class="text-muted small mb-0">智能邮件收取与摘要生成</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-muted small mb-0">
                        <i class="fas fa-tools me-1"></i>
                        紧急维护中，预计 <span id="footer-time">1小时</span> 后恢复
                    </p>
            </div>
        </div>
    </div>
    </footer>

    <script src="/static/vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <script>
        // 维护页面JavaScript功能
        document.addEventListener('DOMContentLoaded', function() {
            // 计算维护时间
            calculateMaintenanceTimes();
            
            // 启动进度模拟
            simulateProgress();
            
            // 每30秒更新一次时间
            setInterval(updateTimes, 30000);
        });

        // 计算维护开始时间和预计结束时间
        function calculateMaintenanceTimes() {
            const now = new Date();
            
            // 开始时间设为当前时间前15分钟（紧急维护）
            const startTime = new Date(now.getTime() - 15 * 60 * 1000);
            
            // 结束时间设为当前时间后1小时的整点
            const endTime = new Date();
            endTime.setHours(now.getHours() + 1, 0, 0, 0); // 下一个整点
            
            // 格式化时间显示
            const formatOptions = {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                hour12: false,
                timeZone: 'Asia/Shanghai'
            };
            
            // 更新页面显示
            document.getElementById('start-time').textContent = startTime.toLocaleString('zh-CN', formatOptions);
            document.getElementById('end-time').textContent = endTime.toLocaleString('zh-CN', formatOptions);
            
            // 更新预计完成时间（只显示时间）
            const timeOnly = endTime.toLocaleTimeString('zh-CN', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            });
            document.getElementById('estimated-time').textContent = timeOnly;
            
            // 更新页脚时间
            const remaining = endTime.getTime() - now.getTime();
            const minutes = Math.ceil(remaining / (1000 * 60));
            document.getElementById('footer-time').textContent = `${minutes}分钟`;
            
            // 存储结束时间用于倒计时
            window.maintenanceEndTime = endTime;
        }

        // 模拟维护进度（紧急维护进度较慢）
        function simulateProgress() {
            const now = new Date();
            const startTime = new Date(now.getTime() - 15 * 60 * 1000); // 15分钟前开始
            const endTime = window.maintenanceEndTime;
            
            // 计算总维护时长（毫秒）
            const totalDuration = endTime.getTime() - startTime.getTime();
            
            // 计算已经过去的时间
            const elapsed = now.getTime() - startTime.getTime();
            
            // 计算进度百分比（紧急维护进度较慢）
            let progress = Math.max(0, Math.min(100, (elapsed / totalDuration) * 100));
            
            // 紧急维护进度更慢，添加延迟因子
            progress = Math.min(80, progress * 0.7 + Math.random() * 5);
            
            // 更新进度显示
            updateProgress(Math.round(progress));
            
            // 每分钟更新一次进度
            setInterval(() => {
                const currentTime = new Date();
                const currentElapsed = currentTime.getTime() - startTime.getTime();
                let currentProgress = Math.max(0, Math.min(100, (currentElapsed / totalDuration) * 100));
                currentProgress = Math.min(90, currentProgress * 0.7 + Math.random() * 3);
                updateProgress(Math.round(currentProgress));
            }, 60000);
        }

        // 更新进度显示
        function updateProgress(percentage) {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const maintenanceProgress = document.getElementById('maintenance-progress');
            
            // 更新进度条
            progressBar.style.width = percentage + '%';
            progressBar.setAttribute('aria-valuenow', percentage);
            
            // 更新进度文本（紧急维护用词）
            if (percentage < 20) {
                progressText.textContent = '服务诊断中...';
            } else if (percentage < 40) {
                progressText.textContent = '核心服务重启中...';
            } else if (percentage < 60) {
                progressText.textContent = '数据库恢复中...';
            } else if (percentage < 80) {
                progressText.textContent = '安全检查中...';
            } else if (percentage < 95) {
                progressText.textContent = '服务验证中...';
            } else {
                progressText.textContent = '即将完成...';
            }
            
            // 更新统计卡片中的进度
            maintenanceProgress.textContent = percentage;
            
            // 根据进度更新进度条颜色（紧急维护用红色开始）
            if (percentage < 20) {
                progressBar.className = 'progress-bar bg-danger progress-bar-striped progress-bar-animated';
            } else if (percentage < 50) {
                progressBar.className = 'progress-bar bg-warning progress-bar-striped progress-bar-animated';
            } else {
                progressBar.className = 'progress-bar bg-success progress-bar-striped progress-bar-animated';
            }
        }

        // 更新时间显示
        function updateTimes() {
            const now = new Date();
            const endTime = window.maintenanceEndTime;
            
            if (endTime && now < endTime) {
                const remaining = endTime.getTime() - now.getTime();
                const minutes = Math.ceil(remaining / (1000 * 60));
                
                if (minutes > 0) {
                    document.getElementById('estimated-time').textContent = `${minutes}分钟后`;
                    document.getElementById('footer-time').textContent = `${minutes}分钟`;
                } else {
                    document.getElementById('estimated-time').textContent = '即将完成';
                    document.getElementById('footer-time').textContent = '即将';
                }
            }
        }

        // 添加紧急维护状态更新
        function addEmergencyEffects() {
            // 随机更新紧急修复功能状态
            const features = document.querySelectorAll('.feature-item .badge');
            
            setInterval(() => {
                features.forEach((badge, index) => {
                    if (badge.textContent === '进行中' && Math.random() > 0.8) {
                        // 有20%概率将"进行中"变为"已完成"
                        badge.textContent = '已完成';
                        badge.className = 'badge bg-success';
                        
                        // 如果有下一个功能，将其状态改为"进行中"
                        if (features[index + 1] && features[index + 1].textContent === '待开始') {
                            features[index + 1].textContent = '进行中';
                            features[index + 1].className = 'badge bg-warning';
                        }
                    }
                });
            }, 90000); // 每1.5分钟检查一次（紧急维护更频繁）
        }

        // 启动紧急维护效果
        setTimeout(addEmergencyEffects, 3000);

        // 添加页面刷新提示
        function showRefreshReminder() {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert alert-warning alert-dismissible fade show position-fixed';
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
                <i class="fas fa-exclamation-triangle me-2"></i>
                紧急维护中，建议每2分钟刷新页面获取最新状态
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(alertDiv);
            
            // 10秒后自动移除
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.parentNode.removeChild(alertDiv);
                }
            }, 10000);
        }

        // 3分钟后显示刷新提醒（紧急维护更早提醒）
        setTimeout(showRefreshReminder, 180000);
    </script>
</body>
</html>
